# Файл задания

Формат файла - JSON. Файлы, сохраняемые в программной модели, шифруются алгоритмом AES-256/CBC/PKCS7 с использованием ключа из хеш-суммы SHA-256 от Ф. И. О. студента. Блок шифротекста предваряется вектором инициализации. Файлы, сохраняемые в конструкторе заданий, не шифруются. Задания хранятся в виде массива объектов.

# Структура файла

| Поле             | Тип   | Описание |
| ---------------- | ----- | -------- |
| Корневой элемент | [[MemoryTask](#memorytask) \| [ProcessesTask](#processestask)] | Массив из объектов, описывающих задания |

## MemoryTask

Задание "Диспетчеризация памяти"

| Поле | Тип    | Описание |
| ---- | ------ | -------- |
| type | String | Тип задания. Значение: `MEMORY_TASK` |
| strategy | String | Название стратегии. Допустимые значения: `FIRST_APPROPRIATE`, `MOST_APPROPRIATE`, `LEAST_APPROPRIATE` |
| completed | Number | Количество обработанных заявок |
| fails | Number | Количество допущенных пользователем ошибок |
| state | [MemoryState](#memorystate) | Объект, описывающий состояние памяти |
| requests | [[CreateProcess](#createprocess) \| [TerminateProcess](#terminateprocess) \| [AllocateMemory](#allocatememory) \| [FreeMemory](#freememory)] | Массив заявок, которые диспетчер должен обработать |
| actions | \[String\] | Массив строк, содержащих информацию о действиях пользователя для каждой заявки |

## MemoryState

Дескриптор состояния памяти

В данной модели адресное пространство разбито на 256 страниц по 4096 байт. Наименьшая единица адресного пространства, доступная для выделения процессу - страница. Выделять можно только целое число страниц.

Процессам в данной модели могут присваиваться идентификаторы (PID) от 0 до 255 включительно.

Непрерывная область памяти, состоящая из одной и более страниц и имеющая начальный адрес и размер, называется блоком памяти.

Состояние памяти определяется совокупностью всех блоков памяти. Каждая страница адресного пространства должна находиться в одном и только одном блоке памяти, т.е. последовательность блоков памяти, упорядоченных по начальному адресу, должна полностью покрыть адресное пространство.

Под начальным состоянием памяти подразумевается такое состояние памяти, при котором все адресное пространство покрыто одним свободным блоком памяти с начальным адресом 0 и размером 256.

Программная модель разработана исходя из того, что перед обработкой первой заявки память находится в начальном состоянии.

| Поле | Тип    | Описание |
| ---- | ------ | -------- |
| blocks | [[MemoryBlock](#memoryblock)] | Массив из дескрипторов всех доступных блоков памяти |
| free_blocks | [[MemoryBlock](#memoryblock)] | Массив из дескрипторов свободных блоков памяти, упорядоченных согласно стратегии |

## MemoryBlock

Дескриптор блока памяти

| Поле | Тип    | Описание |
| ---- | ------ | -------- |
| pid | Number | PID процесса, которому выделен данный блок или -1, если блок свободный |
| address | Number | Адрес начала блока памяти в страницах |
| size | Number | Размер блока памяти в страницах |

Ограничения, накладываемые на поля:

- `-1 <= pid <= 255`
- `0 <= address <= 255`
- `1 <= size <= 256`
- `address + size <= 256`

## CreateProcess

Заявка на создание процесса

| Поле | Тип    | Описание |
| ---- | ------ | -------- |
| type | String | Тип заявки. Значение: `CREATE_PROCESS` |
| pid | Number | PID процесса |
| bytes | Number | Запрашиваемый объем памяти в байтах |

Ограничения, накладываемые на поля:

- `0 <= pid <= 255`
- `1 <= bytes <= 256 * 4096`

## TerminateProcess

Заявка на завершение процесса

| Поле | Тип    | Описание |
| ---- | ------ | -------- |
| type | String | Тип заявки. Значение: `TERMINATE_PROCESS` |
| pid | Number | PID процесса |

Ограничение, накладываемые на поля:

- `0 <= pid <= 255`

## AllocateMemory

Заявка на выделение блока памяти процессу

| Поле | Тип    | Описание |
| ---- | ------ | -------- |
| type | String | Тип заявки. Значение: `ALLOCATE_MEMORY` |
| pid | Number | PID процесса |
| bytes | Number | Запрашиваемый объем памяти в байтах |

Ограничения, накладываемые на поля:

- `0 <= pid <= 255`
- `1 <= bytes <= 256 * 4096`

## FreeMemory

Заявка на освобождение блока памяти

| Поле | Тип    | Описание |
| ---- | ------ | -------- |
| type | String | Тип заявки. Значение: `FREE_MEMORY` |
| pid | Number | PID процесса |
| address | Number | Адрес начала блока памяти в страницах |

Ограничения, накладываемые на поля:

- `0 <= pid <= 255`
- `0 <= address <= 255`

## ProcessesTask

Задание "Диспетчеризация процессов"

| Поле | Тип    | Описание |
| ---- | ------ | -------- |
| type | String | Тип задания. Значение: `PROCESSES_TASK` |
| strategy | String | Название стратегии. Допустимые значения: `ROUNDROBIN`, `FCFS`, `SJN`, `SRT`, `WINNT` |
| completed | Number | Количество обработанных заявок |
| fails | Number | Количество допущенных пользователем ошибок |
| state | [ProcessesState](#processesstate) | Объект, описывающий состояние процессов |
| requests | [[CreateProcessReq](#createprocessreq) \| [TerminateProcessReq](#terminateprocessreq) \| [InitIO](#initio) \| [TerminateIO](#terminateio)] \| [TransferControl](#transfercontrol) \| [TimeQuantumExpired](#timequantumexpired) | Массив заявок, которые диспетчер должен обработать |

## ProcessesState

Дескриптор состояния процессов

Процессам в данной модели могут присваиваться идентификаторы (PID) от 0 до 255 включительно.

Программная модель разработана исходя из того, что перед обработкой первой заявки очереди пусты и ни один процесс не создан.

| Поле | Тип    | Описание |
| ---- | ------ | -------- |
| processes | [[Process](#process)] | Массив из дескрипторов процессов |
| queues | [[Number]] | Массив из 16 очередей, каждая - массив из идентификаторов процессоа |

## Process

Дескриптор процесса

| Поле | Тип    | Описание |
| ---- | ------ | -------- |
| pid | Number | PID процесса |
| ppid | Number | PID родительского процесса или -1 |
| priority | Number | Приоритет |
| basePriority | Number | Базовый приоритет |
| timer | Number | Время работы |
| workTime | Number | Заявленное время работы |
| state | String | Состояние процесса. Допустимые значения: `ACTIVE`, `EXECUTING`, `WAITING` |

Ограничения, накладываемые на поля:

- `0 <= pid <= 255`
- `-1 <= ppid <= 255`
- `0 <= priority <= 15`
- `0 <= basePriority <= 15`
- `basePriority <= priority`
- `timer >= 0`
- `workTime >= 0`

## CreateProcessReq

Заявка на создание нового процесса

| Поле | Тип    | Описание |
| ---- | ------ | -------- |
| type | String | Тип заявки. Значение: `CREATE_PROCESS` |
| pid | Number | PID процесса |
| ppid | Number | PID родительского процесса или -1 |
| priority | Number | Приоритет |
| basePriority | Number | Базовый приоритет |
| timer | Number | Время работы |
| workTime | Number | Заявленное время работы |

Ограничения, накладываемые на поля:

- `0 <= pid <= 255`
- `-1 <= ppid <= 255`
- `0 <= priority <= 15`
- `0 <= basePriority <= 15`
- `basePriority <= priority`
- `timer >= 0`
- `workTime >= 0`

## TerminateProcessReq

Заявка на завершение существующего процесса

| Поле | Тип    | Описание |
| ---- | ------ | -------- |
| type | String | Тип заявки. Значение: `TERMINATE_PROCESS` |
| pid | Number | PID процесса |

Ограничение, накладываемые на поля:

- `0 <= pid <= 255`

## InitIO

Заявка на инициализацию ввода/вывода

| Поле | Тип    | Описание |
| ---- | ------ | -------- |
| type | String | Тип заявки. Значение: `INIT_IO` |
| pid | Number | PID процесса |

Ограничение, накладываемые на поля:

- `0 <= pid <= 255`

## TerminateIO

Заявка на завершение ввода/вывода

| Поле | Тип    | Описание |
| ---- | ------ | -------- |
| type | String | Тип заявки. Значение: `TERMINATE_IO` |
| pid | Number | PID процесса |
| augment | Number | Прибавка к текущему приоритету |

Ограничения, накладываемые на поля:

- `0 <= pid <= 255`
- `1 <= augment <= 15`

## TransferControl

Заявка на передачу управления операционной системе

| Поле | Тип    | Описание |
| ---- | ------ | -------- |
| type | String | Тип заявки. Значение: `TRANSFER_CONTROL` |
| pid | Number | PID процесса |

Ограничение, накладываемые на поля:

- `0 <= pid <= 255`

## TimeQuantumExpired

Заявка на обработку события "Истек квант времени"

| Поле | Тип    | Описание |
| ---- | ------ | -------- |
| type | String | Тип заявки. Значение: `TIME_QUANTUM_EXPIRED` |
